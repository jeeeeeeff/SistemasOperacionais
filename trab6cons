#include "defs.h"
sems *las;

int main(int argc, char *argv[])
{
    alarm(200);
    int idM = atoi(argv[1]);
    printf("P: alo %d\n", idM);
    las = shmat(idM, 0, 0);
    while(1)
    {
        int item = 0;
        sleep(rand() % 15);

        sem_wait(&(las->full));
        pthread_mutex_lock(&(las->cons));

        if(!remove_item(las, &item))
            printf("Consumindo %d\n", item);
        else
            fprintf(stderr, "Consimudor em erro: Algo deu ruim\n");

        pthread_mutex_unlock(&(las->cons));
        sem_post(&(las->empty));
    }
}
